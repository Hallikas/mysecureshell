#!/bin/sh

usage()
{
    printf "Usage:\n"$0" [username]\n\nusername: specify the user name to kill or enter all to kill all\n";
}

if [ $1 ] ; then
    if [ $1 == "all" ] ; then 
	pid=`sftp-who --sftp-kill | awk '{ print $1 }'`
	who=`sftp-who --sftp-kill | awk '{ print $2 }'`
	if [ "$who" != "" ] ; then
	    echo "Kill user(s) ["$who"]"
	    kill -HUP $pid
	else
	    echo "Sorry but the server is empty"
	fi    
    else 
	if [ $1 == "--help" ] ; then
	    usage
	else
	    pid=`sftp-who --sftp-kill | grep $1 | awk '{ print $1 }'`
	    who=`sftp-who --sftp-kill | grep $1 | awk '{ print $2 }'`
	    if [ "$who" != "" ] ; then
		echo "Kill '"$who"' on PID "$pid
		kill -HUP $pid
	    else 
		echo "Sorry but '"$1"' isn't connected !" 
	    fi
	fi
    fi
else
    usage
fi
